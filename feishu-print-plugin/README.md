# 飞书多维表格打印插件

一个功能完整的飞书多维表格打印插件，支持自定义排版、预览和导出 PDF。

## 功能特性

✅ **多种打印范围**
- 当前视图
- 所有记录
- 选中的记录

✅ **灵活的排版设置**
- 纸张方向（纵向/横向）
- 纸张大小（A4/A3/Letter）
- 表格边框显示/隐藏
- 表头显示/隐藏

✅ **实用功能**
- 实时预览
- 直接打印
- 导出 PDF

## 安装步骤

### 方式一：本地开发调试

1. **安装依赖**
```bash
cd feishu-print-plugin
npm install
```

2. **启动本地服务器**
```bash
npm run dev
```
服务器将在 `http://localhost:3000` 启动

3. **在飞书中添加插件**
   - 打开飞书多维表格
   - 点击右上角 **"扩展"** → **"脚本与自动化"**
   - 选择 **"添加脚本"** → **"开发者模式"**
   - 输入地址：`http://localhost:3000`

### 方式二：直接部署使用

1. **将 src 目录部署到你的服务器**
   - 上传 `src` 文件夹中的所有文件
   - 确保可以通过 HTTPS 访问

2. **在飞书中添加插件**
   - 打开飞书多维表格
   - 点击 **"扩展"** → **"添加自定义插件"**
   - 输入你的部署地址（必须是 HTTPS）

## 使用说明

### 1. 基本使用

1. 打开飞书多维表格
2. 点击已安装的 **"表格打印助手"** 插件
3. 选择打印设置
4. 点击"预览"查看效果
5. 点击"打印"或"导出PDF"

### 2. 打印范围说明

- **当前视图**：打印当前视图中显示的所有记录
- **所有记录**：打印表格中的所有记录（不受视图筛选影响）
- **选中的记录**：仅打印当前选中的记录

### 3. 排版设置

- **纸张方向**：
  - 纵向：适合字段较少的表格
  - 横向：适合字段较多的宽表格

- **纸张大小**：
  - A4：最常用（210×297mm）
  - A3：大尺寸（297×420mm）
  - Letter：美国标准（216×279mm）

### 4. 导出 PDF

点击"导出PDF"按钮，系统会自动生成 PDF 文件并下载到本地。

文件名格式：`表格打印_[时间戳].pdf`

## 技术栈

- **飞书 SDK**：`@lark-base-open/js-sdk`
- **PDF 生成**：`jsPDF` + `html2canvas`
- **样式**：原生 CSS
- **JavaScript**：ES6+

## 项目结构

```
feishu-print-plugin/
├── src/
│   ├── index.html      # 主页面
│   ├── main.js         # 主要逻辑
│   └── style.css       # 样式文件
├── package.json        # 依赖配置
├── config.json         # 插件配置
└── README.md          # 说明文档
```

## 支持的字段类型

✅ 文本
✅ 数字
✅ 单选
✅ 多选
✅ 日期
✅ 复选框
✅ 人员
✅ 电话
✅ 超链接
✅ 附件

## 常见问题

### Q: 为什么预览显示正常，但打印时样式不对？

A: 这可能是浏览器打印设置的问题。请在打印对话框中：
- 取消勾选"页眉和页脚"
- 确保"背景图形"已启用
- 检查页边距设置

### Q: 导出的 PDF 文件过大？

A: 当表格数据较多时，PDF 文件会变大。建议：
- 使用"当前视图"减少导出数据量
- 分批次打印
- 只选择必要的字段

### Q: 某些字段显示为空？

A: 请检查：
- 该字段是否有权限访问
- 字段类型是否受支持
- 数据格式是否正确

### Q: 本地开发时无法连接？

A: 确保：
- 本地服务器已启动（npm run dev）
- 飞书可以访问 localhost:3000
- 没有被防火墙拦截

## 更新日志

### v1.0.0 (2024-12-17)
- ✨ 初始版本发布
- ✅ 支持基本打印功能
- ✅ 支持预览和 PDF 导出
- ✅ 支持多种排版设置

## 授权许可

MIT License

## 联系方式

如有问题或建议，欢迎反馈！

---

**注意事项：**
1. 插件需要在飞书多维表格环境中运行
2. 确保已授予必要的权限（读取表格、字段、记录）
3. 大数据量打印可能需要较长时间，请耐心等待
